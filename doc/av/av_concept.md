、音视频概述

## 流媒体收发过程

![流媒体收发过程](.\res\流媒体收发过程.jpg)

如上，流媒体传输主要有三个阶段：采集，编码，传输。

* 采集：需要对音视频信号进行采集，采集方式根据实际需求而定，如音视频采集卡，摄像头，麦克风。
* 编码：编码将音视频信号转换为数字信号，以便对其进行传输，主要有H264，其中分为encode，mux。
* 传输：传输是将音视频信号传输到后端，主要有RTMP，RTSP，WebRtc等。

![音视频采集](.\res\mux.webp)

流媒体接收主要有三个阶段：接收，解码，播放。

* 接收：接收将后端的音视频信号进行接收，主要有RTMP，RTSP，WebRtc等。

* 解码：将音视频信号进行解码，解码主要是将数字信号转为音视频信号，主要有H264等。

* 播放：是将音视频信号数据进行同步后播放，主要有VLC，也有自研的[kplayer](https://github.com/reachithard/kplayer)

  ![音视频播放](.\res\demux.webp)

## 视频主要概念

![视频主要概念](.\res\video_base.png)

* 码率

  码率，又叫比特率，单位时间内传输的数据量，单位一般为kbps(千位每秒)。需要注意的是，这里b代表bit，而不是byte。计算公式：平均码率(kbps)=文件大小(kb)X8/时间(s)。动态码率(kbps)=每秒传输数据量(kb)X8。

  恒定码率：CBR，码率稳定可控，带宽要求不高，图像变化量比较大时方块效应比较明显。

  动态码率：VBR，码率波动较大，带宽要求较高，图像变化量比较大时方块效应有所改善。发生网络抖动时，比较容易丢包，需要重传，或者FEC前向纠错，从而带来延时。

* 分辨率
  分辨率又称为解析度，分辨率越高，像素越多，图像越清晰。

* 帧率

  测量显示帧数的量度，单位为每秒显示帧数(FPS，全称为Frame Per Second)。

* stride

  指在内存中每行像素所占的空间。为了实现内存对齐每行像素在内存中所占的空间并不一定是图像的宽度。 

  ![stride](.\res\stride.webp)

* 帧

  帧是视频开发常见的一个基本概念，可以表示为一张画面，一个段视频本质上就是有许多画面组成，因此，一个视频就是由许许多多的视频帧组成。

  在视频数据的压缩处理中，每帧都代表着一副画面，由于视频前后两帧的画面极为相似，因此可以通过前一帧的画面数据来进行压缩或者解压缩，根据参考的帧的不同，可以划分为 I 帧、P 帧 和 B 帧。

  - I 帧：（Intra Picture）帧内编码帧，也叫关键帧，I 帧不需要参考其他帧就可以进行解码。
  - P 帧：（Predictive-Frame）向前预测编码帧，即需要参考前面的一帧才能进行解码。
  - B 帧：（bi-directional interpolated prediction frame）双向预测内插编码帧，也叫双向预测帧。即需要参考前面已编码的帧，又需要参考图像序列后面的已编码帧，才能进行解码。
  - IDR帧：IDR帧也是I帧，但I帧不一定是IDR帧，出现了IDR帧立即刷新。

* GOP

  GOP ，Group of Picture ，指的是两个 I 帧之间的间隔。





